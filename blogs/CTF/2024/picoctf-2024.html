<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-rc.18">
    <script>
      (function() {
        const userMode = localStorage.getItem('vuepress-reco-color-scheme') || 'auto';
        const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (userMode === 'dark' || (userMode === 'auto' && systemDarkMode)) {
          document.documentElement.classList.toggle('dark', true);
        }
      })();
    </script>
    <link rel="icon" href="/alimi.ico"><title>PicoCTF 2024 | d0qbu's blog</title><meta name="description" content="d0qbu's blog to share something I knew">
    <link rel="preload" href="/assets/style-CLjLGmBa.css" as="style"><link rel="stylesheet" href="/assets/style-CLjLGmBa.css">
    <link rel="modulepreload" href="/assets/app-BJjiZhLy.js"><link rel="modulepreload" href="/assets/picoctf-2024.html-DUXLUr9W.js">
    <link rel="prefetch" href="/assets/timeline.html-Dxk7sbyB.js" as="script"><link rel="prefetch" href="/assets/posts.html-svjq6049.js" as="script"><link rel="prefetch" href="/assets/friendship-link.html-DnusWWj3.js" as="script"><link rel="prefetch" href="/assets/1.html-D0ekpFwU.js" as="script"><link rel="prefetch" href="/assets/1.html-D-VJtKmR.js" as="script"><link rel="prefetch" href="/assets/1.html-DtlQzd4D.js" as="script"><link rel="prefetch" href="/assets/1.html-DxyjHmfe.js" as="script"><link rel="prefetch" href="/assets/1.html-mEFscRrH.js" as="script"><link rel="prefetch" href="/assets/1.html-K0Og4IjV.js" as="script"><link rel="prefetch" href="/assets/1.html-C56FgLwa.js" as="script"><link rel="prefetch" href="/assets/1.html-TWxB8BbY.js" as="script"><link rel="prefetch" href="/assets/1.html-gldDPc-a.js" as="script"><link rel="prefetch" href="/assets/1.html-CuKlQTZu.js" as="script"><link rel="prefetch" href="/assets/1.html-dCabBEr6.js" as="script"><link rel="prefetch" href="/assets/1.html-BzoJhmkV.js" as="script"><link rel="prefetch" href="/assets/1.html-3Zc5XUkc.js" as="script"><link rel="prefetch" href="/assets/index.html-XHz8wPa0.js" as="script"><link rel="prefetch" href="/assets/wannagame-freshman-2023.html-CsRvqhSO.js" as="script"><link rel="prefetch" href="/assets/CVE-2024-44902.html-T8TPcMVJ.js" as="script"><link rel="prefetch" href="/assets/cyber-apocalypse-2024.html-BFTdxU_i.js" as="script"><link rel="prefetch" href="/assets/greycatctf-2024.html-Bmf_YGFB.js" as="script"><link rel="prefetch" href="/assets/mysql-tcp.html--H7-qYyh.js" as="script"><link rel="prefetch" href="/assets/prototype-pollution-bios.html-QPgq_n3y.js" as="script"><link rel="prefetch" href="/assets/404.html-C9_lKTdL.js" as="script"><link rel="prefetch" href="/assets/Valine.min-BDHOk_jE.js" as="script"><link rel="prefetch" href="/assets/giscus-aTimukGI-CpBH_6Jv.js" as="script"><link rel="prefetch" href="/assets/setupDevtools-7MC2TMWH-s98YujfD.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container series--no show-catalog"><header class="navbar-container not-open"><div class="navbar-inner"><div class="site-brand nav-item"><!----><a href="/" class="site-name">d0qbu&#39;s blog</a></div><div class="nav-item navbar-links-wrapper" style=""><div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div><nav class="navbar-links"><!--[--><div class="navbar-links__item"><a href="/" class="link" aria-label="Home"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Home<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/timeline.html" class="link" aria-label="Timeline"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Timeline<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/categories/CTF/1.html" class="link" aria-label="Categories"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Categories<!--]--></span></span><!--[--><!--]--></a></div><!--]--><!----><span class="xicon-container btn-toggle-dark-mode btn--dark-mode navbar-links__item"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></span><ul class="social-links navbar-links__item"><!--[--><li class="social-item"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:25px;height:25px;"><path d="M16 2a14 14 0 0 0-4.43 27.28c.7.13 1-.3 1-.67v-2.38c-3.89.84-4.71-1.88-4.71-1.88a3.71 3.71 0 0 0-1.62-2.05c-1.27-.86.1-.85.1-.85a2.94 2.94 0 0 1 2.14 1.45a3 3 0 0 0 4.08 1.16a2.93 2.93 0 0 1 .88-1.87c-3.1-.36-6.37-1.56-6.37-6.92a5.4 5.4 0 0 1 1.44-3.76a5 5 0 0 1 .14-3.7s1.17-.38 3.85 1.43a13.3 13.3 0 0 1 7 0c2.67-1.81 3.84-1.43 3.84-1.43a5 5 0 0 1 .14 3.7a5.4 5.4 0 0 1 1.44 3.76c0 5.38-3.27 6.56-6.39 6.91a3.33 3.33 0 0 1 .95 2.59v3.84c0 .46.25.81 1 .67A14 14 0 0 0 16 2z" fill-rule="evenodd" fill="currentColor"></path></svg></li><!--]--></ul></nav><span class="xicon-container btn-toggle-menus"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:;"><circle cx="16" cy="8" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="24" r="2" fill="currentColor"></circle></svg></span></div></div></header><!----><!----><!----><div class="theme-main" style=""><!----><!--[--><main class="page-container"><div class="page-content"><h1 class="page-title">PicoCTF 2024</h1><div class="page-info"><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M16 4a5 5 0 1 1-5 5a5 5 0 0 1 5-5m0-2a7 7 0 1 0 7 7a7 7 0 0 0-7-7z" fill="currentColor"></path><path d="M26 30h-2v-5a5 5 0 0 0-5-5h-6a5 5 0 0 0-5 5v5H6v-5a7 7 0 0 1 7-7h6a7 7 0 0 1 7 7z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->d0qbu<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->2024-03-27<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M11.17 6l3.42 3.41l.58.59H28v16H4V6h7.17m0-2H4a2 2 0 0 0-2 2v20a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2H16l-3.41-3.41A2 2 0 0 0 11.17 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[--><!--[--><a href="/categories/CTF/1.html" class="">CTF</a><!--]--><!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M10 14a4 4 0 1 1 4-4a4.005 4.005 0 0 1-4 4zm0-6a2 2 0 1 0 1.998 2.004A2.002 2.002 0 0 0 10 8z" fill="currentColor"></path><path d="M16.644 29.415L2.586 15.354A2 2 0 0 1 2 13.941V4a2 2 0 0 1 2-2h9.941a2 2 0 0 1 1.414.586l14.06 14.058a2 2 0 0 1 0 2.828l-9.943 9.943a2 2 0 0 1-2.829 0zM4 4v9.942L18.058 28L28 18.058L13.942 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[--><!--[--><a href="/tags/NoSQL/1.html" class="">NoSQL</a><a href="/tags/FileUpload/1.html" class="">FileUpload</a><a href="/tags/RCE/1.html" class="">RCE</a><a href="/tags/Shellescape/1.html" class="">Shellescape</a><!--]--><!--]--></span></span><!----></div><div class="theme-reco-md-content"><div><p>PicoCTF2024 là giải Weekly đầu tiên trong năm 2024 của CLB và cũng có thể xem là giải debut của team mình dù đã hoạt động từ lâu. Dù không thể giải quyết hết tất cả các challenge nhưng KHÔNG QUAN TRỌNG 💣💥💥, bọn mình cũng đã cố gắng hết sức.</p><p><img src="/assets/picoctf-2024-CiCP06BS.png" alt="image"></p><p>Dưới đây là writeup của một số bài trong PicoCTF</p><h2 id="general-binhexa" tabindex="-1"><a class="header-anchor" href="#general-binhexa"><span>GENERAL: binhexa</span></a></h2><div class="custom-container info"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 8h.01"></path><path d="M11 12h1v4h1"></path></g></svg><p class="custom-container-title">Challenge</p><p>How well can you perfom basic binary operations? Start searching for the flag here <code>nc titan.picoctf.net</code></p></div><p>Bài yêu cầu connect tới server nc và trả lời một số câu hỏi trong thời gian nhất định. Sau khi trả lời đủ sau câu sẽ yêu cầu trả lời lại câu hỏi cuối cùng để confirm và gửi flag. <img src="/assets/picoctf-2024-1-CJo7j0GJ.png" alt="image"></p><p>Đây là script của mình để solve bài này.</p><details class="custom-container details"><summary class="custom-container-title">solve.py</summary><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span></span>
<span class="line"></span>
<span class="line">conn <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">&quot;titan.picoctf.net&quot;</span><span class="token punctuation">,</span> PORT<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">conn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b&quot;Your task is to perform the unique operations in the given order and find the final result in hexadecimal that yields the flag.\n\n&quot;</span><span class="token punctuation">)</span></span>
<span class="line">bin1 <span class="token operator">=</span> conn<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span></span>
<span class="line">bin2 <span class="token operator">=</span> conn<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">calc</span><span class="token punctuation">(</span>bin1<span class="token punctuation">,</span> bin2<span class="token punctuation">,</span> ope<span class="token punctuation">,</span> option<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>option <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;0b</span><span class="token interpolation"><span class="token punctuation">{</span>bin1<span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span>ope<span class="token punctuation">}</span></span><span class="token string"> 0b</span><span class="token interpolation"><span class="token punctuation">{</span>bin2<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">elif</span> <span class="token punctuation">(</span>option <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;0b</span><span class="token interpolation"><span class="token punctuation">{</span>bin1<span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span>ope<span class="token punctuation">}</span></span><span class="token string"> 1&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;0b</span><span class="token interpolation"><span class="token punctuation">{</span>bin2<span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span>ope<span class="token punctuation">}</span></span><span class="token string"> 1&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">tmp <span class="token operator">=</span> <span class="token string">&quot;&quot;</span></span>
<span class="line"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    conn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b&quot;Operation &quot;</span><span class="token punctuation">)</span></span>
<span class="line">    conn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b&quot;: &quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    ope <span class="token operator">=</span> conn<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot;&#39;&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    res <span class="token operator">=</span> conn<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>bin1<span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span>ope<span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span>bin2<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    conn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b&quot;Enter the binary result: &quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">b&quot;1&amp;2&quot;</span> <span class="token keyword">in</span> res<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        res <span class="token operator">=</span> calc<span class="token punctuation">(</span>bin1<span class="token punctuation">,</span> bin2<span class="token punctuation">,</span> ope<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">        conn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>res<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">elif</span> <span class="token punctuation">(</span><span class="token string">b&quot;Number 1&quot;</span> <span class="token keyword">in</span> res<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        res <span class="token operator">=</span> calc<span class="token punctuation">(</span>bin1<span class="token punctuation">,</span> bin2<span class="token punctuation">,</span> ope<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">        conn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>res<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">elif</span> <span class="token punctuation">(</span><span class="token string">b&quot;Number 2&quot;</span> <span class="token keyword">in</span> res<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        res <span class="token operator">=</span> calc<span class="token punctuation">(</span>bin1<span class="token punctuation">,</span> bin2<span class="token punctuation">,</span> ope<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">        conn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>res<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        tmp <span class="token operator">=</span> res</span>
<span class="line"></span>
<span class="line">conn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b&quot;Enter the results of the last operation in hexadecimal: &quot;</span><span class="token punctuation">)</span></span>
<span class="line">conn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">conn<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h2 id="general-dont-you-love-banners" tabindex="-1"><a class="header-anchor" href="#general-dont-you-love-banners"><span>GENERAL: dont-you-love-banners</span></a></h2><div class="custom-container info"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 8h.01"></path><path d="M11 12h1v4h1"></path></g></svg><p class="custom-container-title">Challenge</p><p>Can you abuse the banner? Additional details will be available after launching your challenge instance.</p></div><p>Trước tiên ta cần trả lời một số câu hỏi đơn giản, sau khi trả lời xong sẽ được xài bash <img src="/assets/picoctf-2024-2-CrVKlwJl.png" alt="image"></p><p>Kiểm tra thì thấy có script python đang chạy ở <code>/root</code><img src="/assets/picoctf-2024-3-CdjMtctE.png" alt="image"> Ở đây có file <code>flag.txt</code> nhưng bị giới hạn quyền chỉ cho user <code>root</code> đọc file.</p><p>Còn có <code>script.py</code> của user <code>root</code>, cho phép ta đọc nội dung của file đó. Đọc thử file <code>script.py</code> sẽ thấy code sẽ đọc nội dung từ file <code>/home/player/banner</code> và print ra khi chạy sript <img src="/assets/picoctf-2024-4-4ixvz_Os.png" alt="image"></p><p>--&gt; Ta có thể xài symlynk để khi đọc file <code>/home/player/banner</code> nó sẽ tự trỏ tới file <code>/root/flag.txt</code> để đọc và print ra. Sau khi tạo symlink, kiểm tra sẽ thấy banner trỏ tới flag.txt <img src="/assets/picoctf-2024-5-B5S9auxW.png" alt="image"> Bây giờ chỉ việc nc lại là có flag</p><blockquote><p>Bài này còn một cách khác là leo quyền lên root với password là <code>iloveyou</code> 🤨</p></blockquote><h2 id="general-sansalpha" tabindex="-1"><a class="header-anchor" href="#general-sansalpha"><span>GENERAL: SansAlpha</span></a></h2><div class="custom-container info"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 8h.01"></path><path d="M11 12h1v4h1"></path></g></svg><p class="custom-container-title">Challenge</p><p>The Multiverse is within your grasp! Unfortunately, the server that contains the secrets of the multiverse is in a universe where keyboards only have numbers and (most) symbols. Additional details will be available after launching your challenge instance.</p></div><p>Bài cho phép ta sử dụng command nhưng lại ban gần như hầu hết các kí tự alphabet, chỉ có thể xài số và các kí tự đặc biệt. --&gt; Mình nghĩ đến hướng sử dụng <a href="https://tldp.org/LDP/GNU-Linux-Tools-Summary/html/x11655.htm" target="_blank" rel="noopener noreferrer">wildcards<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> để thay thế.</p><p>Trước tiên cần tìm flag file nằm đâu, sau khi fuzz thì mò ra nó nằm ở <code>blargh/flag.txt</code><img src="/assets/picoctf-2024-6-BVAQSyGq.png" alt="image"></p><p>Tiếp theo ta cần tìm cách đọc file flag Vì có thể xài ký tự số nên mình tìm các lệnh có chứa ký tự số có thể xài được <img src="/assets/picoctf-2024-7-CmUrOGV1.png" alt="image"></p><p>Ta thấy có base32 (base64) có thể xài được nên có thể sử dụng <code>/???/???/????32</code> để gọi đến <code>/usr/bin/base32</code> và đọc file <img src="/assets/picoctf-2024-8-BSK3Ptwc.png" alt="image"></p><blockquote><p>Ngoài ra còn một số lệnh có thể sử dụng như <code>/usr/bin/diff3</code>, <code>/usr/bin/pdb3.8</code> (vì script chạy với python3.8)</p><p>Một cách làm khác khá hay từ người anh họ Hứa <code>&quot;$(&lt;./??????/????.???)&quot;</code></p></blockquote><h2 id="web-no-sql-injection" tabindex="-1"><a class="header-anchor" href="#web-no-sql-injection"><span>WEB: No Sql Injection</span></a></h2><div class="custom-container info"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 8h.01"></path><path d="M11 12h1v4h1"></path></g></svg><p class="custom-container-title">Challenge</p><p>Can you try to get access to this website to get the flag? You can download the source <a href="https://artifacts.picoctf.net/c_atlas/34/app.tar.gz" target="_blank" rel="noopener noreferrer">here<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>. The website is running <a href="http://atlas.picoctf.net:53436/" target="_blank" rel="noopener noreferrer">here<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>. Can you log in?</p></div><p>App sử dụng database là MongoDB, khi POST <code>/login</code> sẽ gửi JSON gồm email và password cho server <img src="/assets/picoctf-2024-9-BCCDbMYm.png" alt="image"></p><p>Query của MongoDB ta có thể thêm vào một object có key là <code>$regex</code> để match query thỏa điều kiện của regex đó. Như thế, ta chỉ cần đưa vào email là <code>joshiriya355@mumbama.com</code> và password match <code>.*</code>.</p><p>Tuy nhiên nếu đưa object vào password sẽ bị lỗi, vì ở phần code xử lý sẽ check password bắt đầu bằng &quot;{&quot; và kết thúc bằng &quot;}&quot; là syntax của JSON, khi đó code sẽ tự parse string đó thành JSON object <img src="/assets/picoctf-2024-10-CWwXfR8Q.png" alt="image"></p><p>Giờ chỉ việc POST lên với password là JSON string sẽ được token, decode token và ra flag <img src="/assets/picoctf-2024-11-B-Bisgp8.png" alt="image"></p><h2 id="web-trickster" tabindex="-1"><a class="header-anchor" href="#web-trickster"><span>WEB: Trickster</span></a></h2><div class="custom-container info"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 8h.01"></path><path d="M11 12h1v4h1"></path></g></svg><p class="custom-container-title">Challenge</p><p>I found a web app that can help process images: PNG images only! Additional details will be available after launching your challenge instance.</p></div><p>Web cho phép upload hình ảnh lên, khi check <code>/robots.txt</code> ta thấy có 2 path là <code>/instructions.txt</code> và <code>/uploads/</code>. Folder upload là nơi sẽ chứa các file mình up lên server.</p><details class="custom-container details"><summary class="custom-container-title">/instructions.txt</summary><p>Let&#39;s create a web app for PNG Images processing. It needs to: Allow users to upload PNG images</p><p><strong>look for &quot;.png&quot; extension</strong> in the submitted files</p><p>make sure the <strong>magic bytes match</strong> (not sure what this is exactly but wikipedia says that the first few bytes contain &#39;PNG&#39; in hexadecimal: &quot;50 4E 47&quot; )</p><p>After validation, store the uploaded files so that the admin can retrieve them later and do the necessary processing.</p></details><p>Code sẽ check file có phải PNG hay không dựa vào</p><ul><li>File header</li><li>Tên file có chứa &quot;.png&quot;</li></ul><p>Vì Backend sử dụng PHP/8.0.30, ta chỉ cần upload file php lên chạy hàm <code>shell_exec</code> để RCE <img src="/assets/picoctf-2024-12-BDN6pLa1.png" alt="image"></p><p><img src="/assets/picoctf-2024-13-Bpulg1ml.png" alt="image"></p><h2 id="" tabindex="-1"><a class="header-anchor" href="#"><span></span></a></h2><p>Check out mah teammates&#39; blog: <a href="https://clowncs.github.io/picoctf2024/" target="_blank" rel="noopener noreferrer">@clowncs<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, <a href="https://s19ma.github.io/posts/2024/picoCTF_2024.html" target="_blank" rel="noopener noreferrer">s1gm4🦆<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, <a href="https://hackmd.io/@n3g4tee/H16kbFm0T" target="_blank" rel="noopener noreferrer">n3g4tee<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p></div></div><footer class="page-meta"><div class="meta-item edit-link"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:;"><path d="M2 26h28v2H2z" fill="currentColor"></path><path d="M25.4 9c.8-.8.8-2 0-2.8l-3.6-3.6c-.8-.8-2-.8-2.8 0l-15 15V24h6.4l15-15zm-5-5L24 7.6l-3 3L17.4 7l3-3zM6 22v-3.6l10-10l3.6 3.6l-10 10H6z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Edit this page<!--]--></span></span></div><div class="meta-item last-updated"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Last Updated 12/16/2024, 9:07:24 AM<!--]--></span></span></div></footer><!----><!----></div><div class="page-catalog-container"><h5 class="tip">ON THIS PAGE</h5><ul><!--[--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/CTF/2024/picoctf-2024.html#general-binhexa" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="GENERAL: binhexa"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->GENERAL: binhexa<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/CTF/2024/picoctf-2024.html#general-dont-you-love-banners" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="GENERAL: dont-you-love-banners"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->GENERAL: dont-you-love-banners<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/CTF/2024/picoctf-2024.html#general-sansalpha" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="GENERAL: SansAlpha"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->GENERAL: SansAlpha<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/CTF/2024/picoctf-2024.html#web-no-sql-injection" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="WEB: No Sql Injection"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->WEB: No Sql Injection<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/CTF/2024/picoctf-2024.html#web-trickster" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="WEB: Trickster"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->WEB: Trickster<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/CTF/2024/picoctf-2024.html#" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label><!--[--><!--]--><span class="xicon-container"><!----></span><!--[--><!--]--></a></li><!--]--><!--]--></ul></div></main><!--]--></div></div><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BJjiZhLy.js" defer></script>
  </body>
</html>
